{
  "hash": "3aaefa7f26926c023369c61c9daa2dec",
  "result": {
    "markdown": "---\ntitle: \"BCB 520 - Midterm Portfolio Post\"\nsubtitle: \"Comparing University of Idaho grants to similar schools\"\nauthor: \"Robyn Steveley\"\ndate: \"2024-03-14\"\ncategories: [assignment]\nimage: \"PerspectivePainting.jpg\"\n\ncode-fold: true\ncode-tools: true\ndescription: \"In Progress...\"\ndraft: false\n---\n\n\n# Preamble\n\nThis post compares the University of Idaho grant awards from the department of agriculture (USDA), the department of energy (DOE), the national institute of health (NIH), and the national science foundation (NSF) to other similar universities.\n\n# The Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(knitr)\nlibrary(scales)\n```\n:::\n\n\n**Department of Agriculture (USDA)**\n\nThis is the data set from the USDA. link here:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#USDA data (each school in different file)\n\n#reading in the data from the files\nUSDAdata_UI <- read.csv(\"USDAtoUI.csv\")  #University of Idaho\nUSDAdata_BSU <- read.csv(\"USDABSU.csv\")  #Boise State University\nUSDAdata_ISU <- read.csv(\"USDAISU.csv\")  #Idaho State University\nUSDAdata_MSU <- read.csv(\"USDAMSU.csv\")  #Montana State University\nUSDAdata_UM <- read.csv(\"USDAUofM.csv\")  #University of Montana\nUSDAdata_WSU <- read.csv(\"USDAWSU.csv\")  #Washington State University\n\n#combining all schools into one dataframe\nUSDAdata_all <- rbind(USDAdata_UI, USDAdata_BSU, USDAdata_ISU, USDAdata_MSU, USDAdata_UM, USDAdata_WSU)\n\n#picking out the columns that might be useful\nUSDA_data_main <- USDAdata_all %>% select(Award.Date, Grant.Title, Grantee.Name, Award.Dollars, Program.Name, Program.Area.Name)\n\n#adding column: Source: USDA\nUSDA_data_main$Source <- 'USDA'\n\n#rename columns\ncolnames(USDA_data_main) <- c('Award Date', 'Grant Title', 'Institution', 'Award Amount', 'Program Name', 'Program Area Name', 'Source')\n\n\n#show table\nknitr::kable(head(USDA_data_main, 4))\n```\n\n::: {.cell-output-display}\n|Award Date |Grant Title |Institution                | Award Amount|Program Name |Program Area Name |Source |\n|:----------|:-----------|:--------------------------|------------:|:------------|:-----------------|:------|\n|2010-09-30 |N/A         |SAES - UNIVERSITY OF IDAHO |         7495|N/A          |N/A               |USDA   |\n|2009-09-30 |N/A         |SAES - UNIVERSITY OF IDAHO |         6813|N/A          |N/A               |USDA   |\n|2008-09-30 |N/A         |SAES - UNIVERSITY OF IDAHO |         8524|N/A          |N/A               |USDA   |\n|2003-09-30 |N/A         |SAES - UNIVERSITY OF IDAHO |         1097|N/A          |N/A               |USDA   |\n:::\n:::\n\n\n**Department of Energy (DOE)**\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#DOE data (for all schools)\n\n#reading in data from file\nsuppressMessages(DOE_data <- read_xlsx(\"DOEawards.xlsx\"))\n\n#vector so i can pick out out only relevant schools\nschools <- c('Regents of the University of Idaho', 'University of Montana', 'Washington State University', 'Boise State University', 'Idaho State University', 'Montana State University')\n\n#picking out the columns that might be useful\nDOE_data_main <- DOE_data %>% \n  filter(Institution %in% schools) %>%\n  select(Institution, PI, Status, 'Action Type', 'Start Date', 'End Date','Most Recent Award Date', 'Amount Awarded to Date', 'Amount Awarded this FY', 'Program Area')\n\n#add column: source: DOE\nDOE_data_main$Source <- 'DOE'\n\n#rename columns\ncolnames(DOE_data_main) <- c('Institution', 'PI', 'Status', 'Is New', 'Start Date', 'End Date', 'Most Recent Award Date', 'Amount Awarded to Date', 'Amount Awarded this FY', 'Program Area Name', 'Source')\n\n#show table\nknitr::kable(head(DOE_data_main, 4))\n```\n\n::: {.cell-output-display}\n|Institution                        |PI                    |Status |Is New  |Start Date |End Date   |Most Recent Award Date | Amount Awarded to Date| Amount Awarded this FY|Program Area Name           |Source |\n|:----------------------------------|:---------------------|:------|:-------|:----------|:----------|:----------------------|----------------------:|----------------------:|:---------------------------|:------|\n|Washington State University        |Cheeke, Tanya         |Active |New     |09/01/2022 |05/31/2025 |02/15/2024             |                 149995|                      0|Atmospheric System Research |DOE    |\n|Regents of the University of Idaho |Sammarruca, Francesca |Active |Renewal |12/01/2021 |11/30/2024 |12/29/2023             |                1812000|                 145000|Nuclear Theory              |DOE    |\n|Washington State University        |Lange, Bernd          |Active |Renewal |08/15/2023 |08/14/2026 |09/25/2023             |                2995804|                      0|Physical Biosciences        |DOE    |\n|Boise State University             |Xiong, Hui (Claire)   |Active |New     |08/15/2023 |08/14/2026 |09/23/2023             |                 599992|                      0|Materials Chemistry         |DOE    |\n:::\n:::\n\n\n**National Institutes of Health (NIH)**\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#NIH data (for all selected schools)\n#this was grabbed from NIH API and converted to file\n\n#reading the data from the file\nNIH_data <- read_xlsx(\"NIH_data.xlsx\")\n\n#picking out columns that might be useful\nNIH_data_main <- NIH_data %>% select(fiscal_year, award_amount, is_active, principal_investigators, contact_pi_name, project_start_date, project_end_date, is_new, project_title, agency_code, organization.org_name) %>% mutate(across(where(is.logical), as.character))\n\n#rename columns\ncolnames(NIH_data_main) <- c('Fiscal Year', 'Award Amount', 'Status', 'PIs', 'PI', 'Start Date', 'End Date', 'Is New', 'Program Name', 'Source', 'Institution')\n\n\n#show table\nknitr::kable(head(NIH_data_main, 4))\n```\n\n::: {.cell-output-display}\n| Fiscal Year| Award Amount|Status |PIs                                                                                 |PI                    |Start Date           |End Date             |Is New |Program Name                                                                                         |Source |Institution           |\n|-----------:|------------:|:------|:-----------------------------------------------------------------------------------|:---------------------|:--------------------|:--------------------|:------|:----------------------------------------------------------------------------------------------------|:------|:---------------------|\n|        2024|       586559|TRUE   |8202174, BORRIES, , DEMELER, TRUE, BORRIES  DEMELER,                                |DEMELER, BORRIES      |2024-03-15T12:03:00Z |2025-03-14T12:03:00Z |FALSE  |Acquisition of a Beckman-Coulter Optima AUC Analytical Ultracentrifuge for the University of Montana |NIH    |UNIVERSITY OF MONTANA |\n|        2024|      2354626|TRUE   |1918945, MICHELLE, Kay, MCGUIRE, TRUE, MICHELLE Kay MCGUIRE, DIRECTOR AND PROFESSOR |MCGUIRE, MICHELLE KAY |2024-03-11T12:03:00Z |2029-01-31T12:01:00Z |FALSE  |COBRE in Nutrition and Women's Health                                                                |NIH    |UNIVERSITY OF IDAHO   |\n|        2024|       461621|TRUE   |12579051, Janet, E., Williams, TRUE, Janet E. Williams, SENIOR RESEARCH SCIENTIST   |WILLIAMS, JANET E.    |2024-03-11T12:03:00Z |2029-01-31T12:01:00Z |FALSE  |Research Core                                                                                        |NIH    |UNIVERSITY OF IDAHO   |\n|        2024|       162320|TRUE   |12311714, Yimin, , Chen, TRUE, Yimin  Chen, ASSISTANT PROFESSOR                     |CHEN, YIMIN           |2024-03-11T12:03:00Z |2029-01-31T12:01:00Z |FALSE  |Research Project - RPL Chen                                                                          |NIH    |UNIVERSITY OF IDAHO   |\n:::\n:::\n\n\n**National Science Foundation (NSF)**\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#NSF data (each school in different file)\n#this was grabbed from NSF API and converted to files\n\n#reading the files\nNSFdata_UI <- read_xlsx(\"NSF_data.xlsx\")  #University of Idaho\nNSFdata_BSU <- read_xlsx(\"NSFtoBSU.xlsx\") #Boise State University\nNSFdata_ISU <- read_xlsx(\"NSFtoISU.xlsx\") #Idaho State University\nNSFdata_MSU <- read_xlsx(\"NSFtoMSU.xlsx\") #Montana State University\nNSFdata_UM <- read_xlsx(\"NSFtoUM.xlsx\")   #University of Montana\nNSFdata_WSU <- read_xlsx(\"NSFtoWSU.xlsx\") #Washington State University\n\n#combining all schools into one dataframe\nNSFdata_all <- rbind(NSFdata_UI, NSFdata_BSU, NSFdata_ISU, NSFdata_MSU, NSFdata_UM, NSFdata_WSU)\n\n#picking out columns that might be useful\nNSF_data_main <- NSFdata_all %>% select(agency, awardeeName, estimatedTotalAmt, fundsObligatedAmt, fundProgramName, pdPIName, startDate, expDate)\n\n#rename columns\ncolnames(NSF_data_main) <- c('Source', 'Institution', 'Estimated Total Amount', 'Funds obligated', 'Program Name', 'PI', 'Start Date', 'End Date')\n\n\n#show table\nknitr::kable(head(NSF_data_main, 4))\n```\n\n::: {.cell-output-display}\n|Source |Institution                        |Estimated Total Amount |Funds obligated |Program Name                   |PI                   |Start Date |End Date   |\n|:------|:----------------------------------|:----------------------|:---------------|:------------------------------|:--------------------|:----------|:----------|\n|NSF    |Regents of the University of Idaho |628415.00              |628415          |Campus Cyberinfrastructure     |Daniel R Ewart       |04/01/2024 |03/31/2026 |\n|NSF    |Regents of the University of Idaho |456051.00              |302462          |UNDERGRADUATE PROGRAMS IN CHEM |Kristopher V Waynant |04/01/2024 |03/31/2027 |\n|NSF    |Regents of the University of Idaho |1000000.00             |1000000         |NSF Engines - Type 1           |Tara Hudiburg        |03/01/2024 |08/31/2025 |\n|NSF    |Regents of the University of Idaho |1179977.00             |546482          |Discovery Research K-12        |Julie M Amador       |12/01/2023 |11/30/2027 |\n:::\n:::\n\n\n**The Combined Data**\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#combining all the data sets together\ncombined_data <- bind_rows(USDA_data_main, DOE_data_main, NIH_data_main, NSF_data_main)\n\n#show table\nknitr::kable(head(combined_data, 4))\n```\n\n::: {.cell-output-display}\n|Award Date |Grant Title |Institution                | Award Amount|Program Name |Program Area Name |Source |PI |Status |Is New |Start Date |End Date |Most Recent Award Date | Amount Awarded to Date| Amount Awarded this FY| Fiscal Year|PIs |Estimated Total Amount |Funds obligated |\n|:----------|:-----------|:--------------------------|------------:|:------------|:-----------------|:------|:--|:------|:------|:----------|:--------|:----------------------|----------------------:|----------------------:|-----------:|:---|:----------------------|:---------------|\n|2010-09-30 |N/A         |SAES - UNIVERSITY OF IDAHO |         7495|N/A          |N/A               |USDA   |NA |NA     |NA     |NA         |NA       |NA                     |                     NA|                     NA|          NA|NA  |NA                     |NA              |\n|2009-09-30 |N/A         |SAES - UNIVERSITY OF IDAHO |         6813|N/A          |N/A               |USDA   |NA |NA     |NA     |NA         |NA       |NA                     |                     NA|                     NA|          NA|NA  |NA                     |NA              |\n|2008-09-30 |N/A         |SAES - UNIVERSITY OF IDAHO |         8524|N/A          |N/A               |USDA   |NA |NA     |NA     |NA         |NA       |NA                     |                     NA|                     NA|          NA|NA  |NA                     |NA              |\n|2003-09-30 |N/A         |SAES - UNIVERSITY OF IDAHO |         1097|N/A          |N/A               |USDA   |NA |NA     |NA     |NA         |NA       |NA                     |                     NA|                     NA|          NA|NA  |NA                     |NA              |\n:::\n:::\n\n\n# Question 1\n\nIn this section we'll look at the following question:\n\nProvide a visualization that shows our active awards from each sponsor. I need to see their start date and end date, the amount of the award, and the name of the Principal Investigator. Iâ€™m really interested in seeing how far into the future our current portfolio will exist. Are there a bunch of awards about to expire? Are there a bunch that just got funded and will be active for a while? Does this vary across sponsors?\n\n**The USDA awards for University of Idaho**\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Overview of award amount per agency for active awards\n\n#filtering the data \n#note for the USDA I'm only using grants that are dated in 2024\ntry({\n#USDA_data_main$'Award Date' <- as.Date(USDA_data_main$'Award Date')\n\nQuestion_1_1_USDA <- USDA_data_main %>%\n  filter(grepl(\"UNIVERSITY OF IDAHO\", Institution)) %>%\n  filter('Award Date' > 2023-01-01) %>%\n  select('Award Amount', 'Source', 'Institution', 'Award Date')\n\ncolnames(Question_1_1_USDA) <- c(\"Amount\", \"Source\", \"Institution\", \"Date\")\n\nQuestion_1_1_DOE <- DOE_data_main %>%\n  filter(grepl(\"UNIVERSITY OF IDAHO\", Institution)) %>%\n  filter(Status == \"Active\") %>%\n  select('Amount Awarded this FY', 'Source', 'Institution', 'End Date')\n\ncolnames(Question_1_1_DOE) <- c(\"Amount\", \"Source\", \"Institution\", \"Date\")\n\nQuestion_1_1_NIH <- NIH_data_main %>%\n  filter(grepl(\"UNIVERSITY OF IDAHO\", Institution)) %>%\n  filter(Status == TRUE) %>%\n  select('Award Amount', 'Source', 'Institution', 'End Date')\n\ncolnames(Question_1_1_NIH) <- c(\"Amount\", \"Source\", \"Institution\", \"Date\")\n\nQuestion_1_1_NSF <- NSF_data_main %>%\n  filter(Institution == \"Regents of the University of Idaho\") %>%\n  filter('End Date' >= 05/30/2024) %>%\n  select('Estimated Total Amount', 'Source', 'Institution', \"End Date\")\n\ncolnames(Question_1_1_NSF) <- c(\"Amount\", \"Source\", \"Institution\", \"Date\")\n\nQuestion_1_1 <- rbind(Question_1_1_USDA, Question_1_1_DOE, Question_1_1_NIH, Question_1_1_NSF)\n}, silent = FALSE)\n\n################  Making the Graph  ################\n\n# sum award money\nQuestion_1_1$Amount <- as.numeric(Question_1_1$Amount)\n\nAward_money_by_source <- Question_1_1 %>%\n  group_by(Source) %>%\n  summarise(TotalAmount = sum(Amount))\n\n# Create bar graph\nggplot(Award_money_by_source, aes(x = Source, y = TotalAmount / 1e6, fill = Source)) +\n  geom_bar(stat = \"identity\") +\n  labs(title = \"Total Award Money per Agency for Active Awards\",\n       x = \"Agency\",\n       y = \"Total Award Money (million)\") +\n  geom_text(aes(label = round(TotalAmount/1e6, digits = 1), vjust = -0.5)) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Midterm_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n**Figure 1.** This graph shows a comparison of total award money for active awards per agency. Note that for NSF, NIH, and DOE awards were considered active if they were labeled as such and for the USDA any award with an award date after April 1st 2023 was considered active.\n\n(or at least that will be what this graph is when i figure out how to actually make the filter by dates work... )\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Gantt graph to look at PIs\n\n# a graph showing pi on vertical axis sorted by amount awarded (highest amount top), with bars representing start and end dates, color coded based on source (NIH, NSF, DOE, or USDA). and set up with a fixed size and bar spacing with a scroll bar for readability if possible. Note: I should only show active so filter by that. Note: USDA will not be able to be included because of lack of start and end dates/ is active tag.\n\n# NIH awards\n\n#Q_1_2_NIH <- NIH_data_main\n\n#Q_1_2_NIH$'Start Date' <- as.Date(Q_1_2_NIH$'Start Date', format = \"%Y-%m-%d\")\n#Q_1_2_NIH$'End Date' <- as.Date(Q_1_2_NIH$'End Date', format = \"%Y-%m-%d\")\n\n\n#ggplot(Q_1_2_NIH, aes(y = PI, x = 'Start Date', xend = 'End Date', yend = PI)) +\n  #geom_segment(linewidth = 4, color = \"violet\") +\n  #scale_x_date(date_breaks = \"1 year\", date_labels = \"%Y\") +\n  #labs(title = \"NIH Active Awards Timeline for PI\",\n      # x = \"Year\",\n      # y = \"Principal Investigator\") +\n  #theme_minimal()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# NSF awards\n#same as above\n\n# DOE awards\n#same as above\n# don't need this one simce no active awards\n```\n:::\n\n\n## Question 2\n\nWhat is the proportional representation of new awards to the UI from these various sources over the past 5 to 10 years? Are there any trends that are encouraging or discouraging?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Trends over time\n\n# a graph showing the number of new awards from each source (or just awards in the case of USDA) vs time, with a different line for each source.\n# a graph showing the amount of money per new awards vs. time for each source.\n\n\n#Question_2_1 <- \n#ggplot\n```\n:::\n\n\n## Comparing the Schools\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# a graph showing a comparison of awards (or award money) given to each school by source. so a clump showing the number of awards (or amount of money) from for example from the NSF for each school then another clump for NIH, etc. Color coded by school for visibility across clumps. Note: active awards only. For the USDA awards use date = 2024\n\n# need to organize data so that the different versions of the schools are all sorted together. so things are grouped based on if each school name is grouped together. I also may need to worry about dates in the different groups, although i do think i need to work with the dates in the above section convert dates \n\nsuppressMessages({\n\nQ3_1_1 <- combined_data %>%\n  filter(Source %in% c(\"NIH\", \"NSF\", \"USDA\", \"DOE\")) %>%\n  #filter(by the date!!!!) %>%\n  mutate(category = case_when(\n      grepl(\"University of Idaho\", Institution, ignore.case = TRUE) ~ \"University of Idaho\",\n      grepl(\"Boise State University\", Institution, ignore.case = TRUE) ~ \"Boise State University\",\n      grepl(\"Idaho State University\", Institution, ignore.case = TRUE) ~ \"Idaho State University\",\n      grepl(\"Montana State University\", Institution, ignore.case = TRUE) ~ \"Montana State University\",\n      grepl(\"University of Montana\", Institution, ignore.case = TRUE) ~ \"University of Montana\",\n      grepl(\"Washington State University\", Institution, ignore.case = TRUE) ~ \"Washington State University\",\n      #TRUE ~ \"Other\"\n      )\n  ) %>%\n  group_by(category, Source) %>%\n    summarise(awards_count = n())\n})\n\n\ninstitution_colors <- c(\"University of Idaho\" = \"gold\", \"Boise State University\" = \"salmon\", \"Idaho State University\" = \"skyblue\", \"Montana State University\" = \"forestgreen\",  \"University of Montana\" = \"violet\",  \"Washington State University\" = \"brown\")\n\n\nggplot(Q3_1_1, aes(x = Source, y = awards_count, fill = category)) + \n  geom_bar(stat=\"identity\", position = \"dodge\") +\n  scale_fill_manual(values = institution_colors, name = \"Institution\") +\n  labs(title = \"Number of Awards Per School (Over All Dates)\",\n       x = \"\",\n       y = \"Number of Awards\") +\n    theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Midterm_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n**Figure ?.** Comparing the number of awards for each school across the whole data set\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#comparing the schools to each other\n\n# a graph comparing trends for each school (are any downturns coming for all the schools?). color coded and shape coded to clump schools, and sources. Colors for schools, shapes for sources, e.g. solid lines for NSF, rect dash for NIH, triangles dash for DOE, dots dash for USDA.\n```\n:::\n\n\n# Conclusion\n\nin conclusion...\n",
    "supporting": [
      "Midterm_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}