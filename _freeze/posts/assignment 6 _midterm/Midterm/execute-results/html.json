{
  "hash": "fbff88a015e29ebf94dba7b82ea39600",
  "result": {
    "markdown": "---\ntitle: \"BCB 520 - Midterm Portfolio Post\"\nsubtitle: \"Comparing University of Idaho grants to similar schools\"\nauthor: \"Robyn Steveley\"\ndate: \"2024-03-14\"\ncategories: [assignment]\nimage: \"PerspectivePainting.jpg\"\n\ncode-fold: true\ncode-tools: true\ndescription: \"In Progress...\"\ndraft: false\n---\n\n\n# Introduction\n\nThis post compares the University of Idaho grant awards from the department of agriculture (USDA), the department of energy (DOE), the national institute of health (NIH), and the national science foundation (NSF) to other similar universities.\n\n## The Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(knitr)\n```\n:::\n\n\n**Department of Agriculture (USDA)**\n\nThis is the data set from the USDA. link here:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#USDA data (each school in different file)\n\n#reading in the data from the files\nUSDAdata_UI <- read.csv(\"USDAtoUI.csv\")  #University of Idaho\nUSDAdata_BSU <- read.csv(\"USDABSU.csv\")  #Boise State University\nUSDAdata_ISU <- read.csv(\"USDAISU.csv\")  #Idaho State University\nUSDAdata_MSU <- read.csv(\"USDAMSU.csv\")  #Montana State University\nUSDAdata_UM <- read.csv(\"USDAUofM.csv\")  #University of Montana\nUSDAdata_WSU <- read.csv(\"USDAWSU.csv\")  #Washington State University\n\n#combining all schools into one dataframe\nUSDAdata_all <- rbind(USDAdata_UI, USDAdata_BSU, USDAdata_ISU, USDAdata_MSU, USDAdata_UM, USDAdata_WSU)\n\n#picking out the columns that might be useful\nUSDA_data_main <- USDAdata_all %>% select(Award.Date, Grant.Title, Grantee.Name, Award.Dollars, Program.Name, Program.Area.Name)\n\n#adding column: Source: USDA\nUSDA_data_main$Source <- 'USDA'\n\n#convert dates to date objects\nUSDA_data_main$'Award.Date' <- as.Date(USDA_data_main$'Award.Date', format = \"%Y-%m-%d\")\n\n#rename columns\ncolnames(USDA_data_main) <- c('Award_Date', 'Grant_Title', 'Institution', 'Award_Amount', 'Program_Name', 'Program_Area_Name', 'Source')\n\n\n#show table\nknitr::kable(head(USDA_data_main, 4))\n```\n\n::: {.cell-output-display}\n|Award_Date |Grant_Title |Institution                | Award_Amount|Program_Name |Program_Area_Name |Source |\n|:----------|:-----------|:--------------------------|------------:|:------------|:-----------------|:------|\n|2010-09-30 |N/A         |SAES - UNIVERSITY OF IDAHO |         7495|N/A          |N/A               |USDA   |\n|2009-09-30 |N/A         |SAES - UNIVERSITY OF IDAHO |         6813|N/A          |N/A               |USDA   |\n|2008-09-30 |N/A         |SAES - UNIVERSITY OF IDAHO |         8524|N/A          |N/A               |USDA   |\n|2003-09-30 |N/A         |SAES - UNIVERSITY OF IDAHO |         1097|N/A          |N/A               |USDA   |\n:::\n:::\n\n\n**Department of Energy (DOE)**\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#DOE data (for all schools)\n\n#reading in data from file\nsuppressMessages(DOE_data <- read_xlsx(\"DOEawards.xlsx\"))\n\n#vector so i can pick out out only relevant schools\nschools <- c('Regents of the University of Idaho', 'University of Montana', 'Washington State University', 'Boise State University', 'Idaho State University', 'Montana State University')\n\n#picking out the columns that might be useful\nDOE_data_main <- DOE_data %>% \n  filter(Institution %in% schools) %>%\n  select(Institution, PI, Status, 'Action Type', 'Start Date', 'End Date','Most Recent Award Date', 'Amount Awarded to Date', 'Amount Awarded this FY', 'Program Area')\n\n#add column: source: DOE\nDOE_data_main$Source <- 'DOE'\n\n#convert dates to date objects\nDOE_data_main$'Start Date' <- as.Date(DOE_data_main$'Start Date', format = \"%m/%d/%Y\")\nDOE_data_main$'End Date' <- as.Date(DOE_data_main$'End Date', format = \"%m/%d/%Y\")\nDOE_data_main$'Most Recent Award Date' <- as.Date(DOE_data_main$'Most Recent Award Date', format = \"%m/%d/%Y\")\n\n#rename columns\ncolnames(DOE_data_main) <- c('Institution', 'PI', 'Status', 'Is_New', 'Start_Date', 'End_Date', 'Most_Recent_Award_Date', 'Amount_Awarded_to_Date', 'Amount_Awarded_this_FY', 'Program_Area_Name', 'Source')\n\n#show table\nknitr::kable(head(DOE_data_main, 4))\n```\n\n::: {.cell-output-display}\n|Institution                        |PI                    |Status |Is_New  |Start_Date |End_Date   |Most_Recent_Award_Date | Amount_Awarded_to_Date| Amount_Awarded_this_FY|Program_Area_Name           |Source |\n|:----------------------------------|:---------------------|:------|:-------|:----------|:----------|:----------------------|----------------------:|----------------------:|:---------------------------|:------|\n|Washington State University        |Cheeke, Tanya         |Active |New     |2022-09-01 |2025-05-31 |2024-02-15             |                 149995|                      0|Atmospheric System Research |DOE    |\n|Regents of the University of Idaho |Sammarruca, Francesca |Active |Renewal |2021-12-01 |2024-11-30 |2023-12-29             |                1812000|                 145000|Nuclear Theory              |DOE    |\n|Washington State University        |Lange, Bernd          |Active |Renewal |2023-08-15 |2026-08-14 |2023-09-25             |                2995804|                      0|Physical Biosciences        |DOE    |\n|Boise State University             |Xiong, Hui (Claire)   |Active |New     |2023-08-15 |2026-08-14 |2023-09-23             |                 599992|                      0|Materials Chemistry         |DOE    |\n:::\n:::\n\n\n**National Institutes of Health (NIH)**\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#NIH data (for all selected schools)\n#this was grabbed from NIH API and converted to file\n\n#reading the data from the file\nNIH_data <- read_xlsx(\"NIH_data.xlsx\")\n\n#picking out columns that might be useful\nNIH_data_main <- NIH_data %>% select(fiscal_year, award_amount, is_active, contact_pi_name, project_start_date, project_end_date, is_new, project_title, agency_code, organization.org_name) %>% mutate(across(where(is.logical), as.character))\n\n#rename columns\ncolnames(NIH_data_main) <- c('Fiscal_Year', 'Award_Amount', 'Status', 'PI', 'Start_Date', 'End_Date', 'Is_New', 'Program_Name', 'Source', 'Institution')\n\n#convert dates to date objects\nNIH_data_main$'Start_Date' <- as.Date(NIH_data_main$'Start_Date', format = \"%Y-%m-%dT%H:%M:%SZ\")\nNIH_data_main$'End_Date' <- as.Date(NIH_data_main$'End_Date', format = \"%Y-%m-%dT%H:%M:%SZ\")\n\n\n\n#show table\nknitr::kable(head(NIH_data_main, 4))\n```\n\n::: {.cell-output-display}\n| Fiscal_Year| Award_Amount|Status |PI                    |Start_Date |End_Date   |Is_New |Program_Name                                                                                         |Source |Institution           |\n|-----------:|------------:|:------|:---------------------|:----------|:----------|:------|:----------------------------------------------------------------------------------------------------|:------|:---------------------|\n|        2024|       586559|TRUE   |DEMELER, BORRIES      |2024-03-15 |2025-03-14 |FALSE  |Acquisition of a Beckman-Coulter Optima AUC Analytical Ultracentrifuge for the University of Montana |NIH    |UNIVERSITY OF MONTANA |\n|        2024|      2354626|TRUE   |MCGUIRE, MICHELLE KAY |2024-03-11 |2029-01-31 |FALSE  |COBRE in Nutrition and Women's Health                                                                |NIH    |UNIVERSITY OF IDAHO   |\n|        2024|       461621|TRUE   |WILLIAMS, JANET E.    |2024-03-11 |2029-01-31 |FALSE  |Research Core                                                                                        |NIH    |UNIVERSITY OF IDAHO   |\n|        2024|       162320|TRUE   |CHEN, YIMIN           |2024-03-11 |2029-01-31 |FALSE  |Research Project - RPL Chen                                                                          |NIH    |UNIVERSITY OF IDAHO   |\n:::\n:::\n\n\n**National Science Foundation (NSF)**\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#NSF data (each school in different file)\n#this was grabbed from NSF API and converted to files\n\n#reading the files\nNSFdata_UI <- read_xlsx(\"NSF_data.xlsx\")  #University of Idaho\nNSFdata_BSU <- read_xlsx(\"NSFtoBSU.xlsx\") #Boise State University\nNSFdata_ISU <- read_xlsx(\"NSFtoISU.xlsx\") #Idaho State University\nNSFdata_MSU <- read_xlsx(\"NSFtoMSU.xlsx\") #Montana State University\nNSFdata_UM <- read_xlsx(\"NSFtoUM.xlsx\")   #University of Montana\nNSFdata_WSU <- read_xlsx(\"NSFtoWSU.xlsx\") #Washington State University\n\n#combining all schools into one dataframe\nNSFdata_all <- rbind(NSFdata_UI, NSFdata_BSU, NSFdata_ISU, NSFdata_MSU, NSFdata_UM, NSFdata_WSU)\n\n#picking out columns that might be useful\nNSF_data_main <- NSFdata_all %>% select(agency, awardeeName, estimatedTotalAmt, fundsObligatedAmt, fundProgramName, pdPIName, startDate, expDate)\n\n#rename columns\ncolnames(NSF_data_main) <- c('Source', 'Institution', 'Estimated_Total_Amount', 'Funds_Obligated', 'Program_Name', 'PI', 'Start_Date', 'End_Date')\n\n#convert dates to date objects\nNSF_data_main$'Start_Date' <- as.Date(NSF_data_main$'Start_Date', format = \"%m/%d/%Y\")\nNSF_data_main$'End_Date' <- as.Date(NSF_data_main$'End_Date', format = \"%m/%d/%Y\")\n\n\n#show table\nknitr::kable(head(NSF_data_main, 4))\n```\n\n::: {.cell-output-display}\n|Source |Institution                        |Estimated_Total_Amount |Funds_Obligated |Program_Name                   |PI                   |Start_Date |End_Date   |\n|:------|:----------------------------------|:----------------------|:---------------|:------------------------------|:--------------------|:----------|:----------|\n|NSF    |Regents of the University of Idaho |628415.00              |628415          |Campus Cyberinfrastructure     |Daniel R Ewart       |2024-04-01 |2026-03-31 |\n|NSF    |Regents of the University of Idaho |456051.00              |302462          |UNDERGRADUATE PROGRAMS IN CHEM |Kristopher V Waynant |2024-04-01 |2027-03-31 |\n|NSF    |Regents of the University of Idaho |1000000.00             |1000000         |NSF Engines - Type 1           |Tara Hudiburg        |2024-03-01 |2025-08-31 |\n|NSF    |Regents of the University of Idaho |1179977.00             |546482          |Discovery Research K-12        |Julie M Amador       |2023-12-01 |2027-11-30 |\n:::\n:::\n\n\n**The Combined Data**\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#combining all the data sets together\ncombined_data <- bind_rows(USDA_data_main, DOE_data_main, NIH_data_main, NSF_data_main)\n\n#show table\nknitr::kable(head(combined_data, 4))\n```\n\n::: {.cell-output-display}\n|Award_Date |Grant_Title |Institution                | Award_Amount|Program_Name |Program_Area_Name |Source |PI |Status |Is_New |Start_Date |End_Date |Most_Recent_Award_Date | Amount_Awarded_to_Date| Amount_Awarded_this_FY| Fiscal_Year|Estimated_Total_Amount |Funds_Obligated |\n|:----------|:-----------|:--------------------------|------------:|:------------|:-----------------|:------|:--|:------|:------|:----------|:--------|:----------------------|----------------------:|----------------------:|-----------:|:----------------------|:---------------|\n|2010-09-30 |N/A         |SAES - UNIVERSITY OF IDAHO |         7495|N/A          |N/A               |USDA   |NA |NA     |NA     |NA         |NA       |NA                     |                     NA|                     NA|          NA|NA                     |NA              |\n|2009-09-30 |N/A         |SAES - UNIVERSITY OF IDAHO |         6813|N/A          |N/A               |USDA   |NA |NA     |NA     |NA         |NA       |NA                     |                     NA|                     NA|          NA|NA                     |NA              |\n|2008-09-30 |N/A         |SAES - UNIVERSITY OF IDAHO |         8524|N/A          |N/A               |USDA   |NA |NA     |NA     |NA         |NA       |NA                     |                     NA|                     NA|          NA|NA                     |NA              |\n|2003-09-30 |N/A         |SAES - UNIVERSITY OF IDAHO |         1097|N/A          |N/A               |USDA   |NA |NA     |NA     |NA         |NA       |NA                     |                     NA|                     NA|          NA|NA                     |NA              |\n:::\n:::\n\n\n# Question 1: Active Awards\n\nIn this section we'll look at the following question:\n\nProvide a visualization that shows our active awards from each sponsor. I need to see their start date and end date, the amount of the award, and the name of the Principal Investigator. I’m really interested in seeing how far into the future our current portfolio will exist. Are there a bunch of awards about to expire? Are there a bunch that just got funded and will be active for a while? Does this vary across sponsors?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Overview of award amount per agency for active awards\n\n#filtering the data \n#Note: for the USDA I have to estimate what should be counted as current\ntry({\n  \nQuestion_1_1_USDA <- USDA_data_main %>%\n  filter(grepl(\"UNIVERSITY OF IDAHO\", Institution)) %>%\n  filter(Award_Date > '2023-06-01') %>%\n  select('Award_Amount', 'Source', 'Institution', 'Award_Date')\n\ncolnames(Question_1_1_USDA) <- c(\"Amount\", \"Source\", \"Institution\", \"Date\")\n\nQuestion_1_1_DOE <- DOE_data_main %>%\n  filter(grepl(\"UNIVERSITY OF IDAHO\", Institution)) %>%\n  filter(Status == \"Active\") %>%\n  select('Amount_Awarded_this_FY', 'Source', 'Institution', 'End_Date')\n\ncolnames(Question_1_1_DOE) <- c(\"Amount\", \"Source\", \"Institution\", \"Date\")\n\nQuestion_1_1_NIH <- NIH_data_main %>%\n  filter(grepl(\"UNIVERSITY OF IDAHO\", Institution)) %>%\n  filter(Status == TRUE) %>%\n  select('Award_Amount', 'Source', 'Institution', 'End_Date')\n\ncolnames(Question_1_1_NIH) <- c(\"Amount\", \"Source\", \"Institution\", \"Date\")\n\n#Note: I might want to use funds obligated instead?\nQuestion_1_1_NSF <- NSF_data_main %>%\n  filter(Institution == \"Regents of the University of Idaho\") %>%\n  filter(End_Date > '2024-01-01') %>%\n  select('Estimated_Total_Amount', 'Source', 'Institution', \"End_Date\") %>%\n  mutate(Estimated_Total_Amount = as.numeric(Estimated_Total_Amount))\n\ncolnames(Question_1_1_NSF) <- c(\"Amount\", \"Source\", \"Institution\", \"Date\")\n\nQuestion_1_1 <- rbind(Question_1_1_USDA, Question_1_1_DOE, Question_1_1_NIH, Question_1_1_NSF)\n}, silent = FALSE)\n\n################  Making the Graph  ################\n\n# sum award money\nQuestion_1_1$Amount <- as.numeric(Question_1_1$Amount)\n\nAward_money_by_source <- Question_1_1 %>%\n  group_by(Source) %>%\n  summarise(TotalAmount = sum(Amount))\n\n# Create bar graph\nggplot(Award_money_by_source, aes(x = Source, y = TotalAmount / 1e6, fill = Source)) +\n  geom_bar(stat = \"identity\") +\n  labs(title = \"Total Award Money per Agency for Active Awards\",\n       x = \"\",\n       y = \"Total Award Money (million)\") +\n  geom_text(aes(label = round(TotalAmount/1e6, digits = 1), vjust = -0.5)) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Midterm_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n**Figure 1.** This graph shows a comparison of total award money for active awards per agency. Note that for NSF, NIH, and DOE awards were considered active if they were labeled as such and for the USDA any award with an award date after April 1st 2023 was considered active.\n\n(or at least that will be what this graph is when i figure out how to actually make the filter by dates work... )\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Gantt graph to look at PIs\n\n#what my plan was:\n# a graph showing pi on vertical axis sorted by amount awarded (highest amount top), with bars representing start and end dates, color coded based on source (NIH, NSF, DOE, or USDA). and set up with a fixed size and bar spacing with a scroll bar for readability if possible. Note: I should only show active so filter by that. Note: USDA will not be able to be included because of lack of start and end dates/ is active tag. Note: DOE will not be included because there are no active awards.\n\n######################################\n\n# NIH awards timeline by PI\n\n#Sorting NIH data\nQ1_2_NIH <- NIH_data_main %>%\n  filter(grepl(\"UNIVERSITY OF IDAHO\", Institution)) %>%\n  filter(Status == TRUE) %>%\n  group_by(PI) %>%\n  reframe(amount = sum(Award_Amount), Start_Date, End_Date)\n  \n#Making the graph \nggplot(Q1_2_NIH, aes(x = Start_Date, xend = End_Date, y = reorder(PI, +amount), yend = PI)) +\n  geom_segment(linewidth = 5, color = \"violet\") +\n  scale_x_date(date_breaks = \"1 year\", date_labels = \"%Y\") +\n  labs(title = \"NIH Active Awards Timeline for PI\",\n       x = \"Year\",\n       y = \"Principal Investigator\") +\n  geom_text(aes(label =  amount), hjust = -1, color = \"black\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Midterm_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# NSF awards timeline by PI\n\n#Sorting the NSF data\nQ1_2_NSF <- NSF_data_main %>%\n  filter(grepl(\"University of Idaho\", Institution)) %>%\n  filter(End_Date > '2024-01-01') %>%\n  mutate(Estimated_Total_Amount = as.numeric(Estimated_Total_Amount)) %>%\n  group_by(PI) %>%\n  reframe(amount = sum(Estimated_Total_Amount), Start = min(Start_Date), End = max(End_Date))\n\n#Making the graph\nggplot(Q1_2_NSF, aes(x = Start, xend = End, y = reorder(PI, +amount), yend = PI)) +\n  geom_segment(linewidth = 2, color = \"lightgreen\") +\n  scale_x_date(date_breaks = \"1 year\", date_labels = \"%Y\") +\n  labs(title = \"NSF Active Awards Timeline for PI\",\n       x = \"Year\",\n       y = \"Principal Investigator\") +\n  geom_text(aes(label =  amount), hjust = -1, color = \"black\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Midterm_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n# Question 2: Trends\n\nWhat is the proportional representation of new awards to the UI from these various sources over the past 5 to 10 years? Are there any trends that are encouraging or discouraging?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Trends over time\n\n# a graph showing the number of new awards from each source (or just awards in the case of USDA) vs time, with a different line for each source.\n# a graph showing the amount of money per new awards vs. time for each source.\n\nsuppressWarnings({\n  suppressMessages({\n  \n# Pick out group based on USDA: awards by date\nQ2_1_USDA <- USDA_data_main %>%\n  filter(grepl(\"UNIVERSITY OF IDAHO\", Institution)) %>%\n  mutate( Award_Date = as.integer(format(Award_Date, \"%Y\"))) %>%\n  select(Award_Date, Institution, Source)\n\n# pick out group based on everything else: awards by start date\nQ2_1_Other <- combined_data %>%\n  filter(grepl(\"UNIVERSITY OF IDAHO\", Institution, ignore.case = TRUE)) %>%\n  filter(Source %in% c(\"NIH\", \"NSF\", \"DOE\")) %>%\n  mutate(Start_Date = as.integer(format(Start_Date, \"%Y\"))) %>%\n  select(Start_Date, Institution, Source) %>%\n  rename(Award_Date = Start_Date)\n  \n#combined everything and grouping it for graph\nQ2_1 <- rbind(Q2_1_USDA, Q2_1_Other) %>%\n  filter(Award_Date >= 2015) %>%\n  group_by(Award_Date, Source) %>%\n  summarise(count = n(), Source)\n\n#Making the graph\nggplot(Q2_1, aes(x = Award_Date , y = count, color = Source)) + \n  geom_line(size = 1) +\n  #scale_color_manual(values = c()) +\n  #scale_linetype_manual(values = c()) +\n  labs(title = \"Number of Awards per Year (Since 2015)\",\n       x = \"Year\",\n       y = \"Number of New Awards\") +\n    theme_minimal()\n\n}) \n})\n```\n\n::: {.cell-output-display}\n![](Midterm_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n# Question 3: Comparing the Schools\n\nIn this section we'll compare the University of Idaho to some other schools.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# a graph showing a comparison of awards (or award money) given to each school by source. so a clump showing the number of awards (or amount of money) from for example from the NSF for each school then another clump for NIH, etc. Color coded by school for visibility across clumps. Note: active awards only. For the USDA awards use date = 2024\n\n# need to organize data so that the different versions of the schools are all sorted together. so things are grouped based on if each school name is grouped together. I also may need to worry about dates in the different groups, although i do think i need to work with the dates in the above section convert dates \n\nsuppressMessages({\n\n#Grouping data by school and filtering by date and agency\nQ3_1 <- combined_data %>%\n  filter(Source %in% c(\"NIH\", \"NSF\", \"USDA\", \"DOE\")) %>%\n  filter(Award_Date > '2010-01-01' | Start_Date > '2010-01-01') %>%\n  mutate(category = case_when(\n      grepl(\"University of Idaho\", Institution, ignore.case = TRUE) ~ \"University of Idaho\",\n      grepl(\"Boise State University\", Institution, ignore.case = TRUE) ~ \"Boise State University\",\n      grepl(\"Idaho State University\", Institution, ignore.case = TRUE) ~ \"Idaho State University\",\n      grepl(\"Montana State University\", Institution, ignore.case = TRUE) ~ \"Montana State University\",\n      grepl(\"University of Montana\", Institution, ignore.case = TRUE) ~ \"University of Montana\",\n      grepl(\"Washington State University\", Institution, ignore.case = TRUE) ~ \"Washington State University\",\n      #TRUE ~ \"Other\"\n      )\n  ) %>%\n  group_by(category, Source) %>%\n    summarise(awards_count = n())\n})\n\n#Picking out colors for bars\ninstitution_colors <- c(\"University of Idaho\" = \"gold\", \"Boise State University\" = \"salmon\", \"Idaho State University\" = \"skyblue\", \"Montana State University\" = \"forestgreen\",  \"University of Montana\" = \"violet\",  \"Washington State University\" = \"brown\")\n\n\n#Making the graph\nggplot(Q3_1, aes(x = Source, y = awards_count, fill = category)) + \n  geom_bar(stat=\"identity\", position = \"dodge\") +\n  scale_fill_manual(values = institution_colors, name = \"School\") +\n  labs(title = \"Number of Awards Per School (After Jan 1 2010)\",\n       x = \"\",\n       y = \"Number of Awards\") +\n    theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Midterm_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n**Figure ?.** Comparing the number of awards for each school across the whole data set\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#comparing the schools to each other\n\n# a graph comparing trends for each school (are any downturns coming for all the schools?). color coded and shape coded to clump schools, and sources. Colors for schools, shapes for sources, e.g. solid lines for NSF, rect dash for NIH, triangles dash for DOE, dots dash for USDA.\n\nsuppressWarnings({\n  suppressMessages({\n  \n# Pick out group based on USDA: awards by date\nQ3_1_USDA <- USDA_data_main %>%\n  mutate( Award_Date = as.integer(format(Award_Date, \"%Y\"))) %>%\n  select(Award_Date, Institution, Source)\n\n# pick out group based on everything else: awards by start date\nQ3_1_Other <- combined_data %>%\n  filter(Source %in% c(\"NIH\", \"NSF\", \"DOE\")) %>%\n  mutate(Start_Date = as.integer(format(Start_Date, \"%Y\"))) %>%\n  select(Start_Date, Institution, Source) %>%\n  rename(Award_Date = Start_Date)\n\n#combined everything and grouping it for graph\nQ3_1 <- rbind(Q3_1_USDA, Q3_1_Other) %>%\n  filter(Award_Date >= 2015) %>%\n   mutate(school = case_when(\n      grepl(\"University of Idaho\", Institution, ignore.case = TRUE) ~ \"University of Idaho\",\n      grepl(\"Boise State University\", Institution, ignore.case = TRUE) ~ \"Boise State University\",\n      grepl(\"Idaho State University\", Institution, ignore.case = TRUE) ~ \"Idaho State University\",\n      grepl(\"Montana State University\", Institution, ignore.case = TRUE) ~ \"Montana State University\",\n      grepl(\"University of Montana\", Institution, ignore.case = TRUE) ~ \"University of Montana\",\n      grepl(\"Washington State University\", Institution, ignore.case = TRUE) ~ \"Washington State University\")) %>%\n  group_by(Award_Date, Source, school) %>%\n  summarise(count = n(), Source, school)\n\n# Agency Lines\nagency_marks <- c('DOE' = 'dotdash', 'NIH' = 'dashed', 'NSF' = 'solid', 'USDA' = 'dotted')\n\n#Making the graph\nggplot(Q3_1, aes(x = Award_Date , y = count, color = school, linetype = Source)) + \n  geom_line(size = 1) +\n  scale_color_manual(values = institution_colors) +\n  scale_linetype_manual(values = agency_marks) +\n  labs(title = \"Number of Awards per Year (Since 2015)\",\n       x = \"Year\",\n       y = \"Number of New Awards\") +\n    theme_minimal()\n\n}) \n})\n```\n\n::: {.cell-output-display}\n![](Midterm_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n# Conclusion\n\nin conclusion...\n",
    "supporting": [
      "Midterm_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}